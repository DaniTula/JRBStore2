{% extends "base.html" %}

{% block title %}JRBStore2 - Cat√°logo{% endblock %}

{% block content %}

<!--
  Barra de navegaci√≥n principal:
  - Men√∫ lateral (offcanvas) 
  - Logo / nombre de la tienda
  - Buscador central
  - Enlaces "Iniciar sesi√≥n / Registrarse" 
-->
<nav class="navbar navbar-dark bg-primary py-1">
  <!--
    container-fluid: ocupa todo el ancho sin dejar tanto espacio lateral
    px-2: un poquito de padding horizontal, para que no quede 100% pegado
  -->
  <div class="container-fluid px-2">

    <!-- Bot√≥n que abre el panel administrativo (offcanvas) -->
    <button class="btn btn-outline-light me-2"
            type="button"
            data-bs-toggle="offcanvas"
            data-bs-target="#adminPanel"
            aria-controls="adminPanel">
      <span class="navbar-toggler-icon"></span>
    </button>

    <!-- Nombre de la tienda, sin margen extra a la derecha -->
    <a class="navbar-brand fw-bold fs-5 me-2" href="#">
      JRBStore
    </a>

    <!-- Buscador central (se muestra solo en pantallas medianas hacia arriba) -->
    <form class="d-none d-md-flex flex-grow-1 justify-content-center mx-2">
      <input class="form-control w-50"
             type="search"
             placeholder="¬øQu√© desea encontrar?"
             aria-label="Buscar" />
    </form>

    <!-- Enlaces de autenticaci√≥n -->
    <div class="d-flex align-items-center text-white ms-2">
      <a href="#" class="text-white text-decoration-none me-1">
        Iniciar sesi√≥n
      </a>
      <span class="mx-1">/</span>
      <a href="#" class="text-white text-decoration-none ms-1">
        Registrarse
      </a>
    </div>
  </div>
</nav>

<!--
  Layout principal:
  - Columna izquierda: filtros (sidebar)
  - Columna derecha: √°rea donde se mostrar√°n productos
-->
<div class="container-fluid py-3">
  <div class="row">

    <!--
      Sidebar de filtros:
      - Consola (select)
      - Tipo (radios)
      - G√©neros (checkboxes)
      - Precio (rangos min / max + botones)
      Usamos bg-primary y text-white para asemejar el dise√±o original.
    -->
    <aside class="col-12 col-md-4 col-lg-3 mb-3">
      <div class="p-3 bg-primary text-white rounded">

        <!-- Filtro: Consola -->
        <div class="mb-4">
          <div class="fw-semibold mb-1">Consola</div>
          <select class="form-select form-select-sm">
            <option selected>Todas</option>
            <option>PlayStation</option>
            <option>Xbox</option>
            <option>Nintendo</option>
            <option>PC</option>
          </select>
        </div>

        <!-- Filtro: Tipo -->
        <div class="mb-4">
          <div class="fw-semibold mb-2">Tipo</div>

          <div class="form-check">
            <input class="form-check-input"
                   type="radio"
                   name="tipo"
                   id="tipoTodos"
                   checked />
            <label class="form-check-label" for="tipoTodos">
              Todos
            </label>
          </div>

          <div class="form-check">
            <input class="form-check-input"
                   type="radio"
                   name="tipo"
                   id="tipoFisico" />
            <label class="form-check-label" for="tipoFisico">
              F√≠sico
            </label>
          </div>

          <div class="form-check">
            <input class="form-check-input"
                   type="radio"
                   name="tipo"
                   id="tipoDigital" />
            <label class="form-check-label" for="tipoDigital">
              Digital/llave
            </label>
          </div>
        </div>

        <!-- Filtro: G√©neros-->
        <div class="mb-4">
          <div class="fw-semibold mb-1">G√©neros</div>

          <!--
            Cada g√©nero es un checkbox independiente.
            Puedes marcar todos los que quieras.
          -->
          <div class="form-check">
            <input class="form-check-input"
                   type="checkbox"
                   value="accion"
                   id="genAccion">
            <label class="form-check-label" for="genAccion">
              Acci√≥n
            </label>
          </div>

          <div class="form-check">
            <input class="form-check-input"
                   type="checkbox"
                   value="aventura"
                   id="genAventura">
            <label class="form-check-label" for="genAventura">
              Aventura
            </label>
          </div>

          <div class="form-check">
            <input class="form-check-input"
                   type="checkbox"
                   value="battle-royale"
                   id="genBattleRoyale">
            <label class="form-check-label" for="genBattleRoyale">
              Battle Royale
            </label>
          </div>

          <div class="form-check">
            <input class="form-check-input"
                   type="checkbox"
                   value="carreras"
                   id="genCarreras">
            <label class="form-check-label" for="genCarreras">
              Carreras
            </label>
          </div>

          <div class="form-check">
            <input class="form-check-input"
                   type="checkbox"
                   value="deportes"
                   id="genDeportes">
            <label class="form-check-label" for="genDeportes">
              Deportes
            </label>
          </div>

          <div class="form-check">
            <input class="form-check-input"
                   type="checkbox"
                   value="estrategia"
                   id="genEstrategia">
            <label class="form-check-label" for="genEstrategia">
              Estrategia
            </label>
          </div>

          <div class="form-check">
            <input class="form-check-input"
                   type="checkbox"
                   value="hack-and-slash"
                   id="genHackSlash">
            <label class="form-check-label" for="genHackSlash">
              Hack and Slash
            </label>
          </div>

          <div class="form-check">
            <input class="form-check-input"
                   type="checkbox"
                   value="rpg"
                   id="genRpg">
            <label class="form-check-label" for="genRpg">
              RPG
            </label>
          </div>

          <div class="form-check">
            <input class="form-check-input"
                   type="checkbox"
                   value="shooter"
                   id="genShooter">
            <label class="form-check-label" for="genShooter">
              Shooter
            </label>
          </div>

          <div class="form-check">
            <input class="form-check-input"
                   type="checkbox"
                   value="terror"
                   id="genTerror">
            <label class="form-check-label" for="genTerror">
              Terror
            </label>
          </div>

          <!-- Texto aclarando que se pueden elegir varias opciones -->
          <small class="d-block mt-1">
            Puedes seleccionar varios.
          </small>
        </div>

        <!-- Filtro: Precio -->
        <div class="mb-3">
          <div class="fw-semibold mb-1">Precio</div>
          <div class="row g-2 mb-2">
            <div class="col-6">
              <!-- Campo para precio m√≠nimo -->
              <input type="number"
                     class="form-control form-control-sm"
                     placeholder="min" />
            </div>
            <div class="col-6">
              <!-- Campo para precio m√°ximo -->
              <input type="number"
                     class="form-control form-control-sm"
                     placeholder="max" />
            </div>
          </div>

          <!-- Bot√≥n para aplicar filtros (no funcional por ahora) -->
          <div class="d-grid mb-2">
            <button class="btn btn-success btn-sm" type="button">
              üîç Aplicar filtros
            </button>
          </div>

          <!-- Bot√≥n para limpiar filtros (no funcional por ahora) -->
          <div class="d-grid">
            <button class="btn btn-outline-light btn-sm" type="button">
              ‚úñ Limpiar
            </button>
          </div>
        </div>

      </div>
    </aside>

    <!--
      √Årea principal:
      - Por ahora solo muestra un mensaje de "A√∫n no hay productos".
      - M√°s adelante aqu√≠ se renderizar√°n tarjetas de productos.
    -->
        <!-- √Årea principal -->
    <main class="col-12 col-md-8 col-lg-9 mb-3">
      {% if productos %}
        <!-- Grid de tarjetas de productos -->
        <div class="row g-3">
          {% for producto in productos %}
            <div class="col-12 col-sm-6 col-md-4 col-lg-3">
                <div class="card h-100 shadow-sm"
                    onmouseover="this.classList.add('shadow')"
                    onmouseout="this.classList.remove('shadow')">
                
                {% if producto.imagen %}
                  <!-- Imagen del producto -->
                  <img src="{{ producto.imagen.url }}"
                       class="card-img-top"
                       alt="{{ producto.nombre }}"
                       style="height: 200px; object-fit: cover;">
                {% endif %}

                <div class="card-body d-flex flex-column">

                  <!-- Nombre del juego -->
                  <h5 class="card-title mb-1">
                    {{ producto.nombre }}
                  </h5>

                  <!-- A√±o, consola, formato, estado -->
                  <p class="mb-1 small text-muted">
                    {{ producto.anio_lanzamiento|date:"Y" }}
                    ¬∑ {{ producto.plataforma }}
                    ¬∑ {{ producto.get_formato_display }}
                    ¬∑ {{ producto.get_estado_display }}
                  </p>

                  <!-- G√©neros -->
                  <p class="mb-1 small text-muted">
                    {{ producto.generos.all|join:", " }}
                  </p>

                  <!-- Descripci√≥n corta -->
                  <p class="card-text small mb-2">
                    {{ producto.descripcion|default:"Sin descripci√≥n."|truncatechars:110 }}
                  </p>

                  <!-- Precio y bot√≥n (placeholder) -->
                  <div class="mt-auto d-flex justify-content-between align-items-center">
                    <span class="fw-bold fs-5">
                      ${{ producto.valor }}
                    </span>
                    <button type="button" class="btn btn-sm btn-primary">
                      Agregar al carrito
                    </button>
                  </div>

                </div>
              </div>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <!-- Mensaje cuando a√∫n no hay productos -->
        <div class="card border-0 shadow-sm h-100">
          <div class="card-body d-flex flex-column justify-content-center align-items-center text-center">
            <div class="mb-3" style="font-size: 3rem;">
              üì¶
            </div>
            <h5 class="card-title mb-2">
              A√∫n no hay productos
            </h5>
            <p class="card-text text-muted">
              Cuando agregues items, aparecer√°n aqu√≠.
            </p>
          </div>
        </div>
      {% endif %}
    </main>

  </div>
</div>

<!--
  Offcanvas (panel lateral) para el "Panel administrativo".
  Se abre al presionar el bot√≥n del navbar.
-->
<div class="offcanvas offcanvas-start"
     tabindex="-1"
     id="adminPanel"
     aria-labelledby="adminPanelLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="adminPanelLabel">
      Panel administrativo
    </h5>
    <button type="button"
            class="btn-close text-reset"
            data-bs-dismiss="offcanvas"
            aria-label="Cerrar"></button>
  </div>

  <div class="offcanvas-body">
    <!-- Lista de enlaces administrativos -->
    <div class="list-group">
      <a href="/admin/" class="list-group-item list-group-item-action">
        Admin Django
      </a>
      <!-- Enlace a nuestra vista product_list -->
      <a href="{% url 'product_list' %}" class="list-group-item list-group-item-action">
        Productos
      </a>
    </div>
  </div>
</div>

{% endblock %}
